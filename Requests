# Request_No:
# Description: What the Rq Do
# Type: GET/POST/DELETE/UPDATE
# URL: lo
# Response: What is given in Response
# SQL_Query: SQL_query to Access DB

Request_No: 01✅
Description: Given a flight no, all passengers travelling in it (next immediate flight) below age 18, above age 18
Type: GET
URL: http://localhost:3000/api/getPassengersByflight
Input: {"flight_ID": "F1"}
Response:{Above, Below}
SQL_Query: SELECT (SELECT COUNT(*) FROM tickets WHERE adult_or_child LIKE '%A%' AND flight = "F1") as Above_18, (SELECT COUNT(*) FROM tickets WHERE adult_or_child LIKE '%C%'AND flight = "F1") as Below_18;

Request_No: 02✅
Description: Given a date range, number of passengers travelling to a given destination
Type: GET
URL: http://localhost:3000/api/getPassengersByDestination
input:
{
"destination_ID": "JFK",
"From_Date": "2022-01-01",
"To_Date": "2023-01-31"
}
Response: {count}
SQL_Query: 
SELECT COUNT(*) FROM tickets WHERE flight IN (SELECT flight_ID FROM flights WHERE (route IN (SELECT route_ID FROM routes WHERE destination_ID = "JFK" ) AND date_of_travel BETWEEN "2022-01-01" AND "2023-01-31"));

Request_No: 03✅
Description: Given a date range, number of bookings by each passenger type
Type: GET
URL: http://localhost:3000/api/getBookingsByPassengerType
input: 
{
"From_Date": "2022-01-01",
"To_Date": "2023-01-31"
}
Response: {passenger_type, count}
SQL_Query: SELECT (SELECT COUNT(*) FROM tickets, users WHERE users.PID = tickets.PID AND Time_of_booking BETWEEN "2022-01-01" AND "2023-01-31" AND user_type LIKE '%G%') AS Guests,
(SELECT COUNT(*) FROM tickets, users WHERE users.PID = tickets.PID AND Time_of_booking BETWEEN "2022-01-01" AND "2023-01-31" AND user_type LIKE '%R%') AS Registered ;

Request_No: 04 ✅
Description: Given origin and destination, all past flights, status, passenger counts data
Type: GET/POST/DELETE/UPDATE
URL: http://localhost:3000/api/getPastflights
input: 
{
"origin_ID": "JFK",
"destination_ID": "LAX"
}
Response: {flight_ID, date_of_travel, flight_Status, count}
SQL_Query:
    SELECT flight_ID, airplane, date_of_travel, dep_time, arr_time, (seat_count-(tickets_RemainingB + tickets_RemainingE + tickets_RemainingP)) as passenger_count
    FROM (flights LEFT JOIN Airplanes_w_seasts ON airplane = airplane_ID)
    WHERE route IN (SELECT route_ID
    FROM routes
    WHERE origin_ID = "BIA" AND destination_ID = "JFK" AND date_of_travel < CURDATE());

Drop view Airplanes_w_seasts;

Request_No: 05✅
Description: Total revenue generated by each Aircraft type
Type: GET
URL: http://localhost:3000/api/getrevenueByAircraftType
input: 
{
"model" : "Airbus"
"brand": "A350"
}
Response: {model, brand, revenue}
SQL_Query:
SELECT model_ID, model, brand, revenue
FROM flights LEFT JOIN (
    SELECT airplane_ID, model_ID, airplane_models.model, brand
    FROM airplanes LEFT JOIN airplane_models
    ON model_ID = airplanes.model) as A
ON airplane = airplane_ID
GROUP BY model_ID;

Request_No: 06 ✅  
Description: Login
Type: GET
URL: http://localhost:3000/Auth/login
input:
{
Email: "Mr",
Password: "John",
}
Response: NONE
SQL_Query: SELECT * FROM users, registered_users WHERE email = 'Email' AND password = 'Password' AND users.PID = registered_users.PID LIMIT 1;

Request_No: 07✅
Description: Register
Type: POST
URL: http://localhost:3000/Auth/Register
input:
{
Title: "Mr",
First_Name: "John",
Last_Name: "Doe",
Email: "Huu@mymail.com",
Telephone: "123",
Country: "USA",
Username: "John",
Password: "123",
Date_of_Birth: "YYYY-MM-DD",
Address: "123",
}
Response: No Response
SQL_Query: Call new_registred_user(Title, First_Name, Last_Name, Email, Telephone, Country, Username, Password, Date_of_Birth, Address);

Request_No: 08 ✅
Description: When From, To and Date Range(From_Date,To_Date) is given then available flights will be shown to the user
Type: GET
URL: Http:/localhost:3000/api/getflights
Input:
{  
 "From": "Location01",  
 "To": "Location02",  
 "From_Date": "FromDate",
"To_Date": "ToDate"
}  
Response: {flight_ID, date_of_travel, dep_time, Arr_time, Tickets_remainingF, Tickets_remainingB, Tickets_remainingE, flight_Status }
SQL_Query:
SELECT flight_ID, date_of_travel, dep_time, Arr_time, Tickets_remainingP, Tickets_remainingB, Tickets_remainingE, flight_Status
FROM flights
WHERE route = (
    SELECT route_ID
    FROM routes
    WHERE origin_ID = 'BIA' AND destination_ID = 'JFK' AND date_of_travel BETWEEN '2021-01-01' AND '2024-01-01' AND date_of_travel > CURDATE()
    ORDER BY date_of_travel
) AND (Tickets_remainingP + Tickets_remainingB + Tickets_remainingE > 0);


Request_No: 09 ✅
Description: Restricted Seats
Type: Get
URL: http://localhost:3000/api/AvailableSeats
input: {"flight_ID": "A1"}
Response: {Class, seat_ID}
SQL_Query:
    SELECT class, seat_ID
    FROM tickets
    WHERE flight = 'F1'
    ORDER BY class, seat_ID;

Request_No: 10 ✅
Description: flight Booking
Type: Post
URL: http://localhost:3000/api/Bookflight
input: {
"flight_ID": "A1",
"Class": "F",
"seat_ID": "A1",
"PID": "123",
"Adult_or_Child": "A"}
Response: NONE
SQL_Query: CALL new_ticket('flight_ID', 'Class', "seat_ID", 'PID', 'Adult_or_Child' );

Request_No: 11 ✅
Description: Cancel Booking
Type: Post
URL: http://localhost:3000/api/CancelBooking
input:
{
"Ticket_ID": "xxxx"
}
Response: NONE
SQL_Query: CALL cancel_ticket("Ticket_ID")

Request_No: 12 
Description: Seat Price
Type: Get
URL: http://localhost:3000/api/SeatPrice
input: 
{
'PID': "11"
'route' : "R1"
'Class': "F"
}
response: {'Price': "100"}
SQL_Query: ticket_price('PID', 'route', 'Class') //Function

Request_No: 13✅
Description: Guest User Login
Type: Post
URL: http://localhost:3000/api/GuestLogin
input:
{
Title: "Mr",
First_Name: "John",
Last_Name: "Doe",
Email: "Huu@mymail.com",
Telephone: "123",
Country: "USA",
}
Response: No response
SQL_Query: INSERT INTO users(title, first_Name, last_Name, email, telephone, country) VALUES (title, First_Name, Last_Name, Email, Telephone, Country);

Request_No: 14✅
Description: Check flight Status
Type: Get
URL: http://localhost:3000/api/flightStatus
Input:
{
"flight_ID": "F1"
}
Response: {flight_Status}
SQL_Query: SELECT flight_Status FROM flights WHERE flight_ID = 'flight_Number';

Request_No: 15 ✅
Description: Get Destinations
Type: Get
URL: http://localhost:3000/api/Destinations
Input: None
Response: {Airport_code, Airport_namee, Location}
Query: SELECT * FROM airports;

Request_No: 16 ✅
Description: Get Details of the Booked flight Along with its Status
Type: Get
URL: http://localhost:3000/api/BookedflightDetails
Input: 
{
"PID": "XXX"
}
Response: {From, To, flight_ID, date_of_travel, dep_time, Arr_time, flight_Status}
Query:
    SELECT origin_ID, destination_ID, date_of_travel, dep_time, Arr_time, flight_Status
    FROM flights RIGHT JOIN routes ON route = route_ID
    WHERE flight_ID in (SELECT flight FROM Tickets WHERE PID = '1') AND date_of_travel >= CURDATE();

Request_No: 17✅
Description: Past flights of the user
Type: Get
URL: http://localhost:3000/api/Pastflights
Input: 
{
"PID": "XXX"
}
Response: {From, To, flight_ID, date_of_travel}
Query: 
    SELECT origin_ID, destination_ID, date_of_travel, dep_time, Arr_time, flight_Status
    FROM flights RIGHT JOIN routes ON route = route_ID
    WHERE flight_ID in (SELECT flight FROM Tickets WHERE PID = '1') AND date_of_travel < CURDATE();

----------------------------- Add New Requests Here ---------------------------------------------

Optional Rq:

1. Get Details of the Registered User
2. Edit User Details
